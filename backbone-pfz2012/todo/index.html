<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Todo</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
      html {
        zoom: 300%;
      }
    </style>
  </head>
  <body>
    <h1>Todos</h1>
    
    <div class="container">

    </div>
    <script src="js/zepto.min.js"></script>
    <script src="js/underscore-min.js"></script>
    <script src="js/backbone-min.js"></script>
    <script src="js/handlebars.js"></script>
    
    <script id="taskTemplate" type="text/x-handlebars-template">
      <ul>
        {{#each tasks}}
          <li>
            {{description}}
          </li>
        {{/each}}
      </ul>
      <button>Add item</button>
    </script>

    <script>
      
      var Task = Backbone.Model.extend({
        
      });
      
      var Tasks = Backbone.Collection.extend({
        model: Task,
        url: "todos.json"
      });
      
      var TaskView = Backbone.View.extend({
        tagName: "div",
        
        template: Handlebars.compile(
          $("#taskTemplate").html()),
        
        events: {
          "click button" : "addItem"
        },
        
        initialize: function() {
          this.model.on("add reset", this.render, this);
        },
        
        addItem: function() {
          var newItem = new Task({description: "New item!"});
          this.model.add(newItem);
          newItem.save();
        },
        
        render: function() {
          var templateData = {
            tasks: this.model.toJSON()
          };
          
          var renderedTemplate =
            this.template(templateData);
          
          this.$el.html(renderedTemplate);
        }
      });

      var tasks = new Tasks();
      
      var taskView = new TaskView({
        model: tasks
      });

      $(".container").html(taskView.el);
      
      tasks.fetch();

    </script>
  </body>
</html>